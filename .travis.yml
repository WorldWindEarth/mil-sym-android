sudo: false
language: android
android:
  components:
    - tools
    - build-tools-23.0.3
    - android-23
    - extra-android-m2repository

jdk:
  - oraclejdk8

env:
  global:
    - secure: grWupPU4/kqfM8o4o23MXZEVmn03/3zaY23LFsSoIrIJMtXPFpNlrq7oo92VKuuSySN1a8p2SO3uPMSXc4CRFPbUB5q2qunBybIOxP/oiUAJKaVVWLk+RRxsiItpxSfvma5++664slSqhd0jmx0Ht13TUcLdMiFOuOin6/9B67/RJQY8M3jAik9dkSqOGBJnneUeWvAmFHMykVHSl3k6AtnL/4eUXGSGwZpwEd3EGaz22YlcdIMae4PvQ1Se1xuiUS7aPUXVKxOhHJs4vUKr5s+6T24tIvUUcS31q2t1oQV3nekXhx0pUptfYFrmPJc/hlfVl+JD20A43eQXvNBLlC7gudml+/SsF82hOXVUxs7p91UG4YJhGSfFrxCJPBbgwxQADFKqb8pawq+kFBLRxCnGwNeonqQMtrOawIgPhK3nitSfvct5gc1GtXMVHiLZlTsSMd0L8zJU6awtJgK7bQB+pLleh7r1+womlJEifHxH76yONSUOIUFC4EbJj+efkYY3hotq/FUerkm8H9g+H4ziLEVLcQsWrTn4x2Etm92TiI4Ze1lZnPoh1XoidVQp/B1gh4dBGMvJk4AGe5UVs4+ZSAwSWdOOSLUZTyR+26QhQ0VvSPVwQGLNxiLUOw4fBNObXSa7q4rxC3hZibh3uf4W/7y5HwwUmJYiMHd2cZ0=
    - secure: EgUyLB7KgqVsxTbRFg54gYEm4+RscEMYE0B28inAczz9RIR0Kje99c5N9pI83DNWl6YA3gv2s47p21IiQXJo1Hc/P5KuOkmCh9M1CexX0X0OduFdAB/47Py5wxmpHjoNQgKz70H1qrNASgeZmmfiloYByaYE/TbNxdx3yNA3u1DDaF10/MzPZL6vQeaRq4NJcFbyQu8b5V5SBvsugKPAWInuKZqYHqS2KHGYFrlZqFxaM+OC1tJxtcV5JKU4sAfEEcFun5+bkgQt4JRGevZsUXO3nJAXQUU/8JqYP/mXXZB8ZdVSWRqg8eAnL4+ntjk28d4NSKvRu5rcT9d7kunddodjJTyGjOX0nlpYFZM4D9dFjYp1Ce4Jb2OLrTnrtx/2gRJ4kEMoOYjrUMrehkVae3N8wx8SBupNTltaVuMJQPYpAqspwK5+pg5pvrQCmpbEFFLOVmN1t9Qv6Rq3xtNzwrSl7yF6sY9XuXAsvNDEwJ9cKNdwr01e3j9Mv9WRPs3eCPVR3t6Jk9+KNugX8Q2zCo/kqkOWqcIzQsOOj9LhrHbLOson3O/ai0bhb7zY31jJB9/FZtxCRSVNEa6fWMqffBghTVyctPxWEQmiZ5kgdvSI0QW/EOSzGPmj0BLtlv85CHY9E02HrRjuJkqX+GHELaYEZ/75AZ2wDGmLWJn8Wpg=

cache:
  directories:
    - $HOME/.gradle/caches/
    - $HOME/.gradle/wrapper/
    - $HOME/.android/build-cache

before_install:
  - chmod +x gradlew
  - chmod +x gradle/release.sh
  - export GRADLE_OPTS="-Dorg.gradle.daemon=false -XX:MaxPermSize=512m -Xmx2048m $GRADLE_OPTS"
  - export DEFAULT_JVM_OPTS=

install: true

script:
 - ./gradlew build --refresh-dependencies --stacktrace

before_cache:
  - rm -f  $HOME/.gradle/caches/modules-2/modules-2.lock
  - rm -fr $HOME/.gradle/caches/*/plugin-resolution/

deploy: # travis by default will not invoke this step for PRs
  - provider: script
    skip_cleanup: true
    script: gradle/release.sh
    on:
      tags: true
      condition: "$TRAVIS_TAG =~ ^v[0-9]+.[0-9]+.[0-9]+$"
